===
MOM
===

MOM (Modular Ocean Model) is an ocean climate model developed at GFDL, and is
the ocean component of the ACCESS climate model system. The latest release of
MOM is version 4.1 (or MOM4p1).

Setting up the work environment
===============================

Creating an NCI account
-----------------------

Most CoE users should expect to run MOM on the NCI computers, such as vayu. To
request an account, visit the `New User Application`_ page at NCI.

Once your account has been created, you may need to connect your username to a
particular project. To do this, visit the `Project Connection Application`_
page at NCI.

You may need to contact your supervisor regarding the details of NCI access.

To verify access to vayu, open a terminal program and attempt an SSH
connection. (If you cannot locate a terminal program, quickly consult the next
section). If your username is `mxw157`, then type the following:

.. code:: bash

    $ ssh mxw157@vayu.nci.org.au

If your password is correct and login is successful, then your account is ready
for use. Type ``exit`` to logout from vayu.

.. _New User Application:
    https://nf.nci.org.au/accounts/forms/user_registration.php

.. _Project Connection Application:
    https://nf.nci.org.au/accounts/forms/user_connection.php

Working in the terminal shell
-----------------------------

Most interaction with the NCI computing environment is done through
command-line terminal emulators. On your computer, you will need to locate an
appropriate terminal application. For some recommendations:

* **OS X**: The default Terminal application is located in the
  ``/Applications/Utilities`` folder.

* **Windows**: PuTTY_ is a good standalone terminal application.

* **Linux**: The default terminal in most distributions should be sufficient.

For a more comprehensive list of terminal, consult the `Wikipedia Terminal
Emulator Comparison`_ page.

.. _PuTTY: http://www.chiark.greenend.org.uk/~sgtatham/putty/
.. _Wikipedia Terminal Emulator Comparison:
    http://en.wikipedia.org/wiki/Comparison_of_SSH_clients

.. TODO: Add details on navigating the shell

.. TODO: Directory structure explanation

Acquiring the source code
-------------------------

The MOM source code can either be downloaded directly from GFDL or through
local source code repositories at NCI. Due to licensing restrictions of the
Unified Model, users must be granted permission to access the local
repositories. For access, contact climate_help@nf.nci.org.au.  

To acquire the latest version of the source code, create a directory in
``/short/${PROJECT}/${USER}/`` and type the following:

.. code:: bash
    
    $ svn co https://access-svn.nci.org.au/svn/mom4/branches/local_changes mom4

Building MOM
------------

Pre-configured scripts for compiling MOM on vayu are included in most of the
repositories. To use the scripts, type the following:

.. code:: bash
    
    $ cd exp
    $ qsub mom4p1_solo_compile.csh

This will submit the ocean-only (or "solo") version of MOM to the queueing
system. Compilation should require approximately 10 minutes, and will place an
executable in the following directory path:

.. code:: bash
    
    /short/${PROJECT}/${USER}/mom4/exec_vayu/mom4p1_solo/fms_mom4p1_solo.x

Several build scripts are included:

* ``mom4p1_solo_compile.csh``: Ocean-only MOM

* ``mom4p1_coupled_compile.csh``: MOM coupled to GFDL's atmosphere, land, and
  ice models

* ``mom4p1_ebm_compile.csh``: MOM coupled to an atmospheric energy-balanced
  model (EBM)

* ``CM2.1p1_compile.csh``: CM2.1-configured GFDL coupled climate model

To build these versions of MOM, submit them in the same manner as outlined
above.

Currently, only the solo and coupled scripts are configured for use on vayu.
Please contact CMS if there is interest in using the other versions.

Running MOM
===========

To run an ocean simulation using MOM, you must prepare the configuration and
data files into a common directory and compile the MOM executable. This section
outlines the steps to run the pre-configured experiments, as well as customised
experiments for individual research.

Sample experiments
------------------

GFDL provides pre-configured scripts and experiments for testing purposes.

Custom experiments
------------------

payu: Python-based workflow scripts
-----------------------------------

.. TODO: Outline usage of the python-based workflow scripts

Model Output Format
===================
